(function(){"use strict";var t={1344:function(t,e,a){var s=a(6848),i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-layout",attrs:{id:"app"}},[e("NavHead"),e("router-view")],1)},n=[],o=function(){var t=this;t._self._c;return t._m(0)},r=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"nav-head"},[e("div",{staticClass:"nav-left"},[e("div",{staticClass:"ai-icon"},[t._v("AI")]),e("div",{staticClass:"nav-title-group"},[e("div",{staticClass:"nav-title"},[t._v("Conflict Simulation")]),e("div",{staticClass:"nav-subtitle"},[t._v("æ™ºèƒ½æ¨¡æ‹Ÿå¯¹è¯ Â· ä¸ªæ€§åŒ–åé¦ˆ")])])]),e("div",{staticClass:"nav-right"},[e("span",{staticClass:"status-dot"}),e("span",{staticClass:"status-text"},[t._v("åœ¨çº¿")]),e("span",{staticClass:"welcome"},[t._v("Ohh")]),e("button",{staticClass:"logout-btn"},[t._v("é€€å‡º")])])])}],c={name:"NavHead"},l=c,d=a(1656),u=(0,d.A)(l,o,r,!1,null,"1756d17a",null),h=u.exports,v={name:"App",components:{NavHead:h}},p=v,f=(0,d.A)(p,i,n,!1,null,null,null),g=f.exports,m=a(9143),_=a.n(m),C=a(6178),b=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-container",[e("el-main",[e("home")],1)],1)],1)],1)},y=[],x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-wrapper"},[e("div",{staticClass:"home-container"},[e("div",{staticClass:"chat-section"},[e("div",{staticClass:"chat-header"},[e("span",{staticClass:"chat-icon"},[t._v("ðŸ¤–")]),e("span",{staticClass:"chat-title"},[t._v("Conflict Simulation")]),e("button",{staticClass:"chat-settings-btn",attrs:{title:"è®¾ç½®å‚æ•°"},on:{click:t.openSettings}},[e("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 25 25",fill:"none"}},[e("path",{attrs:{d:"M10 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z",fill:"#a78bfa"}}),e("path",{attrs:{d:"M19.4 13a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z",fill:"#a78bfa"}})])]),e("button",{staticClass:"chat-reset-btn",attrs:{title:"é‡ç½®å¯¹è¯"},on:{click:t.resetAll}},[e("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20"}},[e("path",{attrs:{d:"M10 2v2a6 6 0 1 1-6 6H2a8 8 0 1 0 8-8z",fill:"#a78bfa"}})])]),e("button",{staticClass:"chat-end-btn",attrs:{title:"ç»“æŸå¯¹è¯"},on:{click:t.endConversation}},[e("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20"}},[e("path",{attrs:{d:"M4 4L16 16M16 4L4 16",stroke:"#a78bfa","stroke-width":"2","stroke-linecap":"round"}})])])]),e("div",{staticClass:"chat-subtitle"},[t._v("æ™ºèƒ½æ¨¡æ‹Ÿå¯¹è¯ Â· ä¸ªæ€§åŒ–å­¦ä¹ æŒ‡å¯¼")]),e("div",{staticClass:"chat-history"},t._l(t.messages,(function(a,s){return e("div",{key:s,class:["chat-bubble",a.role,{user:"user"===a.role,bot:"bot"===a.role}]},["bot"===a.role?e("span",{staticClass:"bubble-icon"},[t._v("ðŸ¤–")]):t._e(),"user"===a.role?e("span",{staticClass:"bubble-icon-user"}):t._e(),"bot"===a.role&&!a.text&&t.loading?[e("span",{staticClass:"loading-spinner-in-bubble",attrs:{title:"æ¨¡åž‹æ€è€ƒä¸­"}})]:[e("span",[t._v(t._s(a.text))])]],2)})),0),e("div",{staticClass:"chat-input-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"chat-input",attrs:{placeholder:"è¯·è¾“å…¥ä½ çš„å›žå¤",disabled:t.loading},domProps:{value:t.input},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)},input:function(e){e.target.composing||(t.input=e.target.value)}}}),e("button",{staticClass:"chat-send-btn",attrs:{disabled:t.loading},on:{click:t.sendMessage}},[e("svg",{attrs:{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M3 20L21 12L3 4V10L17 12L3 14V20Z",fill:"#a78bfa"}})])])])]),e("div",{staticClass:"feedback-section"},[e("div",{staticClass:"card score-feedback"},[e("div",{staticClass:"card-title score-icon"},[t._v("ðŸ“– è¯„åˆ†åé¦ˆ")]),e("div",{staticClass:"score-reason-content"},[t.scoreFeedbackLoading?[e("span",{staticClass:"loading-spinner-in-bubble",attrs:{title:"æ¨¡åž‹æ€è€ƒä¸­"}})]:t.scoreFeedback?[t._v(" "+t._s(t.scoreFeedback)+" ")]:[t._v(" åŸºäºŽä½ çš„å›žå¤è´¨é‡å’Œæ€åº¦ï¼Œç»™å‡ºè¯„åˆ†ä¸Žç†ç”± ")]],2)]),e("div",{staticClass:"card teach-feedback"},[e("div",{staticClass:"card-title teach-icon"},[t._v("ðŸŽ¯ æ•™å­¦åé¦ˆ")]),e("div",{staticClass:"teach-list"},[t.teachFeedbackLoading?[e("span",{staticClass:"loading-spinner-in-bubble",attrs:{title:"æ¨¡åž‹æ€è€ƒä¸­"}})]:t.teachFeedback&&t.teachFeedback.length?t._l(t.teachFeedback,(function(a,s){return e("div",{key:s,class:["teach-item",a.colorClass]},[e("span",{staticClass:"teach-item-icon"},[t._v(t._s(a.icon))]),e("span",{staticClass:"teach-item-title"},[t._v(t._s(a.title))]),e("span",{staticClass:"teach-item-content"},[t._v(t._s(a.content))])])})):[t._m(0),t._m(1),t._m(2),t._m(3)]],2)]),t._m(4)])]),t.showSettingsModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeSettings}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-header"},[e("h3",[t._v("å¯¹è¯è®¾ç½®")]),e("button",{staticClass:"modal-close",on:{click:t.closeSettings}},[t._v("Ã—")])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"training"}},[t._v("å¯¹è¯ç±»åž‹ï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentTraining,expression:"currentTraining"}],staticClass:"form-select",attrs:{id:"training"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentTraining=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"å¼•å¯¼æ€§å¯¹è¯"}},[t._v("å¼•å¯¼æ€§å¯¹è¯")]),e("option",{attrs:{value:"éžå¼•å¯¼æ€§å¯¹è¯"}},[t._v("éžå¼•å¯¼æ€§å¯¹è¯")])])]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"title"}},[t._v("å†²çªåœºæ™¯ï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentTitle,expression:"currentTitle"}],staticClass:"form-select",attrs:{id:"title"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentTitle=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"é›¶èŠ±é’±çš„ä½¿ç”¨"}},[t._v("é›¶èŠ±é’±çš„ä½¿ç”¨")]),e("option",{attrs:{value:"å®¶åŠ¡åˆ†é…ä¸å‡"}},[t._v("å®¶åŠ¡åˆ†é…ä¸å‡")]),e("option",{attrs:{value:"è´¢åŠ¡æ”¯å‡ºäº‰è®®"}},[t._v("è´¢åŠ¡æ”¯å‡ºäº‰è®®")]),e("option",{attrs:{value:"å­å¥³æ•™è‚²äº‰è®®"}},[t._v("å­å¥³æ•™è‚²äº‰è®®")])])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn-cancel",on:{click:t.closeSettings}},[t._v("å–æ¶ˆ")]),e("button",{staticClass:"btn-save",on:{click:t.saveSettings}},[t._v("ä¿å­˜")])])])]):t._e()])},k=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"teach-item teach-yellow"},[e("span",{staticClass:"teach-item-icon"},[t._v("ðŸ’¡")]),e("span",{staticClass:"teach-item-title"},[t._v("NVC")]),e("span",{staticClass:"teach-item-content"},[t._v("éžæš´åŠ›æ²Ÿé€šï¼Œèšç„¦éœ€æ±‚è¡¨è¾¾å’Œæƒ…æ„Ÿç†è§£è€ŒéžæŒ‡è´£ï¼Œè§‚å¯Ÿ-æ„Ÿå—-ç†è§£-éœ€è¦ã€‚")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"teach-item teach-green"},[e("span",{staticClass:"teach-item-icon"},[t._v("â­")]),e("span",{staticClass:"teach-item-title"},[t._v("Proposal")]),e("span",{staticClass:"teach-item-content"},[t._v("ä¸»åŠ¨æå‡ºå…·ä½“è§£å†³æ–¹æ¡ˆï¼Œå¯»æ±‚åŒæ–¹å…±åŒæŽ¥å—çš„è¡ŒåŠ¨æ–¹æ¡ˆã€‚")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"teach-item teach-blue"},[e("span",{staticClass:"teach-item-icon"},[t._v("ðŸ’¡")]),e("span",{staticClass:"teach-item-title"},[t._v("Concession")]),e("span",{staticClass:"teach-item-content"},[t._v("åšå‡ºè®©æ­¥ï¼Œä¸»åŠ¨æ”¾å¼ƒéƒ¨åˆ†éœ€æ±‚ä»¥æ¢å–å†²çªç¼“è§£æˆ–å…³ç³»ç»´æŠ¤ã€‚")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"teach-item teach-purple"},[e("span",{staticClass:"teach-item-icon"},[t._v("â­")]),e("span",{staticClass:"teach-item-title"},[t._v("Promise")]),e("span",{staticClass:"teach-item-content"},[t._v("ä»¥æœªæ¥è¡ŒåŠ¨ä½œä¸ºæ‹…ä¿å’Œæ‰¿è¯ºï¼Œæ¢å–å¯¹æ–¹å½“å‰åˆä½œä¸Žä¿¡ä»»ã€‚")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card study-tips study-tips-yellow"},[e("div",{staticClass:"study-tips-title"},[e("span",{staticClass:"study-tips-icon"},[t._v("ðŸ’¡")]),t._v("å­¦ä¹ å°è´´å£«")]),e("div",{staticClass:"study-tips-content"},[e("span",{staticClass:"study-tips-icon"},[t._v("ðŸ“’")]),t._v("æ¯æ¬¡å¯¹è¯åŽèŠ±å‡ åˆ†é’Ÿæ€»ç»“ç­–ç•¥çš„è¦ç‚¹ï¼Œæœ‰åŠ©äºŽçŸ¥è¯†çš„é•¿æœŸå·©å›ºã€‚")])])}],w=(a(4114),a(8355)),T={name:"HomePage",data(){return{input:"",messages:[{role:"bot",text:"ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„Conflict SimulationåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ æ¨¡æ‹Ÿå’Œåˆ†æžå„ç§å†²çªåœºæ™¯ï¼Œå¹¶æä¾›ä¸ªæ€§åŒ–çš„åé¦ˆã€‚"}],loading:!1,scoreFeedback:null,teachFeedback:[],scoreFeedbackLoading:!1,teachFeedbackLoading:!1,showSettingsModal:!1,currentTraining:"å¼•å¯¼æ€§å¯¹è¯",currentTitle:"é›¶èŠ±é’±çš„ä½¿ç”¨",conversation_id:"",score_id:"",teach_id:"",quit:0}},computed:{lastTime(){return"17:25"}},methods:{async sendMessage(){const t=this.input&&this.input.trim();if(!t||this.loading)return;const e=this.currentTitle;console.log(this.currentTitle),console.log(this.currentTraining),this.messages.push({role:"user",text:t}),this.input="",this.loading=!0,this.$nextTick((()=>{const t=this.$el.querySelector(".chat-history");t&&(t.scrollTop=t.scrollHeight)}));const a={role:"bot",text:""};this.messages.push(a),this.$nextTick((()=>{const t=this.$el.querySelector(".chat-history");t&&(t.scrollTop=t.scrollHeight)}));let s="";try{const i=await fetch("http://dify.ai-role.cn/v1/chat-messages",{method:"POST",headers:{Authorization:"Bearer app-1FfMKOZZ12LF8HXlpXdTopPG","Content-Type":"application/json"},body:JSON.stringify({query:t,inputs:{training:this.currentTraining,title:e,quit:this.quit},response_mode:"streaming",user:"abc-123",conversation_id:this.conversation_id})});if(!i.body||!window.ReadableStream){const n=await i.json();return a.text=n.answer||n.response||"ï¼ˆå¤§æ¨¡åž‹æ— å›žå¤ï¼‰",s=a.text,n.conversation_id&&(this.conversation_id=n.conversation_id),this.loading=!1,this.get_score_feedback(e,t,s),void this.get_teach_feedback(e,t,s)}const n=i.body.getReader(),o=new TextDecoder("utf-8");let r=!1,c="";while(!r){const{value:t,done:e}=await n.read();if(r=e,t){c+=o.decode(t,{stream:!0});let e=c.split("\n");c=e.pop();for(const t of e){if(!t.trim())continue;if(t.startsWith("event: ping"))continue;let e=t;t.startsWith("data:")&&(e=t.replace(/^data:\s*/,""));try{const t=JSON.parse(e);t.answer?a.text+=t.answer:t.response?a.text+=t.response:"string"===typeof t&&(a.text+=t),this.conversation_id=t.conversation_id}catch{a.text+=e}this.$forceUpdate(),this.$nextTick((()=>{const t=this.$el.querySelector(".chat-history");t&&(t.scrollTop=t.scrollHeight)}))}}}if(c&&c.trim()){try{const t=JSON.parse(c);t.answer?a.text+=t.answer:t.response?a.text+=t.response:"string"===typeof t&&(a.text+=t)}catch{a.text+=c}this.$forceUpdate()}s=a.text}catch(i){console.error("APIè¯·æ±‚é”™è¯¯:",i),a.text="æœºå™¨äººæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åŽå†è¯•ã€‚",s=a.text}finally{this.loading=!1,console.log(s),"å¼•å¯¼æ€§å¯¹è¯"===this.currentTraining&&"å› æ‚¨è¿žç»­ä½¿ç”¨æš´åŠ›æ²Ÿé€šï¼Œè¯·æ‚¨å†·é™ä¹‹åŽå†è¿›è¡Œå›žå¤ã€‚Tipsï¼šæŽ¨èä½¿ç”¨NVCç­–ç•¥è¿›è¡Œå›žå¤ã€‚"!=s&&(this.get_score_feedback(e,t,s),this.get_teach_feedback(e,t,s))}},async get_score_feedback(t,e,a){this.scoreFeedbackLoading=!0;try{const s=await w.A.post("http://dify.ai-role.cn/v1/chat-messages",{query:"score feedback",inputs:{title:t,user_response:e,bot_response:a},response_mode:"blocking",user:"abc-123",conversation_id:this.score_id},{headers:{Authorization:"Bearer app-XPpxMLpT4EmwJ2VwXwvmOBPt","Content-Type":"application/json"}});console.log(s.data.answer),this.scoreFeedback=s.data.answer,this.score_id=s.data.conversation_id}catch(s){this.scoreFeedback="è¯„åˆ†åé¦ˆèŽ·å–å¤±è´¥"}finally{this.scoreFeedbackLoading=!1}},async get_teach_feedback(t,e,a){this.teachFeedbackLoading=!0;try{const s=await w.A.post("http://dify.ai-role.cn/v1/chat-messages",{query:"teach feedback",inputs:{title:t,user_response:e,bot_response:a},response_mode:"blocking",user:"abc-123",conversation_id:this.teach_id},{headers:{Authorization:"Bearer app-YhRXu8JFuHs9deDyR8AJwYrC","Content-Type":"application/json"}}),i=s.data.answer||"";console.log("æ•™å­¦åé¦ˆåŽŸå§‹æ•°æ®:",s.data.answer),this.teach_id=s.data.conversation_id;const n=[{title:"NVC",icon:"ðŸ’¡",colorClass:"teach-yellow"},{title:"Proposal",icon:"â­",colorClass:"teach-green"},{title:"Concession",icon:"ðŸ“ˆ",colorClass:"teach-blue"},{title:"Promise",icon:"ðŸŽ¯",colorClass:"teach-purple"}];let o=[];const r=/(NVC|Proposal|Concession|Promise)ï¼š(.*?)(?=(NVC|Proposal|Concession|Promise)ï¼š|$)/gs;let c;while(null!==(c=r.exec(i))){const t=n.findIndex((t=>t.title===c[1]));-1!==t&&(o[t]={...n[t],content:c[2].trim()})}if(0===o.length){const t=i.split("\n").filter((t=>t.trim()));t.forEach((t=>{const e=t.indexOf("ï¼š");if(e>0){const a=t.substring(0,e).trim(),s=t.substring(e+1).trim(),i=n.findIndex((t=>t.title===a));-1!==i&&(o[i]={...n[i],content:s})}}))}console.log("è§£æžåŽçš„æ•™å­¦åé¦ˆ:",o),this.teachFeedback=n.map(((t,e)=>o[e]||{...t,content:"æš‚æ— åé¦ˆå†…å®¹"})),console.log(this.teachFeedback)}catch(s){this.teachFeedback=[]}finally{this.teachFeedbackLoading=!1}},openSettings(){this.showSettingsModal=!0},closeSettings(){this.showSettingsModal=!1},saveSettings(){this.showSettingsModal=!1},resetAll(){this.messages=[{role:"bot",text:"ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„Conflict SimulationåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ æ¨¡æ‹Ÿå’Œåˆ†æžå„ç§å†²çªåœºæ™¯ï¼Œå¹¶æä¾›ä¸ªæ€§åŒ–çš„æŒ‡å¯¼ã€‚"}],this.input="",this.scoreFeedback=null,this.teachFeedback=[],this.scoreFeedbackLoading=!1,this.teachFeedbackLoading=!1,this.conversation_id="",this.score_id="",this.teach_id=""},endConversation(){confirm("ç¡®å®šè¦ç»“æŸå½“å‰å¯¹è¯å—ï¼Ÿç»“æŸåŽå°†è·³è½¬åˆ°è¯„ä¼°é¡µé¢ã€‚")&&(this.$router.push({path:"/evaluation",query:{currentTraining:this.currentTraining,currentTitle:this.currentTitle,conversation_id:this.conversation_id}}),this.resetAll())}}},S=T,O=(0,d.A)(S,x,k,!1,null,"89d9df90",null),F=O.exports,L={name:"MainPage",components:{NavHead:h,Home:F},data(){return{}}},A=L,M=(0,d.A)(A,b,y,!1,null,"596966c9",null),P=M.exports,$=function(){var t=this,e=t._self._c;return e("div",{staticClass:"evaluation-container"},[e("div",{staticClass:"left-card"},[e("div",{staticClass:"radar-title"},[t._v("å¯¹è¯è¡¨çŽ°è¯„ä¼°å›¾")]),e("div",{staticClass:"radar-chart-wrapper"},[t.isLoading?e("div",{staticClass:"loading-container"},[e("div",{staticClass:"loading-spinner"}),e("div",{staticClass:"loading-text"},[t._v("æ­£åœ¨è¯„ä¼°ä¸­...")])]):e("div",{attrs:{id:"radarChart"}})]),e("div",{staticClass:"suggestion-card"},[e("div",{staticClass:"suggestion-title"},[t._v("æ”¹è¿›å»ºè®®")]),e("div",{staticClass:"suggestion-content"},[t.isLoading?e("div",{staticClass:"loading-suggestion"},[e("div",{staticClass:"loading-spinner-small"}),e("div",{staticClass:"loading-text-small"},[t._v("æ­£åœ¨ç”Ÿæˆå»ºè®®...")])]):e("div",[t._v(" "+t._s(t.suggestion||"æš‚æ— æ”¹è¿›å»ºè®®")+" ")])])])]),e("div",{staticClass:"right-cards"},t._l(t.evaluationReasons,(function(a,s){return e("div",{key:s,staticClass:"right-card"},[e("div",{staticClass:"card-content"},[t.isLoading?e("div",{staticClass:"loading-card"},[e("div",{staticClass:"loading-spinner-small"}),e("div",{staticClass:"loading-text-small"},[t._v("è¯„ä¼°ä¸­...")])]):e("div",[e("div",{staticClass:"card-title"},[t._v(t._s(t.radarIndicator[s]?t.radarIndicator[s].name:`ç»´åº¦${s+1}`))]),e("div",{staticClass:"card-score"},[t._v("è¯„åˆ†: "+t._s(t.radarData[s]||0)+"/5")]),e("div",{staticClass:"card-reason"},[t._v(t._s(a||"æš‚æ— è¯„åˆ†ç†ç”±"))])])])])})),0)])},R=[],H=a(1589),q={name:"Evaluation",data(){return{radarIndicator:[],radarData:[],currentTraining:this.$route.query.currentTraining||"",currentTitle:this.$route.query.currentTitle||"",conversation_id:this.$route.query.conversation_id||"",evaluationReasons:["","","","",""],isLoading:!0,suggestion:""}},mounted(){this.getRadarData()},methods:{async getRadarData(){this.isLoading=!0;try{const t=await this.axios.post("http://dify.ai-role.cn/v1/chat-messages",{query:"get evaluation",inputs:{training:this.currentTraining,title:this.currentTitle,quit:1},response_mode:"blocking",user:"abc-123",conversation_id:this.conversation_id},{headers:{Authorization:"Bearer app-1FfMKOZZ12LF8HXlpXdTopPG","Content-Type":"application/json"}});console.log(t);const e=t.data.answer||"";console.log("é›·è¾¾å›¾æ•°æ®:",e),this.parseEvaluationData(e),this.$nextTick((()=>{this.initRadarChart()}))}catch(t){console.error("èŽ·å–é›·è¾¾å›¾æ•°æ®å¤±è´¥:",t),this.radarIndicator=[{name:"å†²çªè½¬åŒ–",max:5},{name:"ç­–ç•¥ä½¿ç”¨",max:5},{name:"æƒ…ç»ªè°ƒèŠ‚",max:5},{name:"ä¸»åŠ¨è¡¨è¾¾",max:5},{name:"å…³ç³»ç»´æŠ¤",max:5}],this.radarData=[2,2,2,2,2],this.evaluationReasons=["é»˜è®¤è¯„åˆ†ç†ç”±ï¼šå†²çªè½¬åŒ–è¡¨çŽ°è‰¯å¥½","é»˜è®¤è¯„åˆ†ç†ç”±ï¼šç­–ç•¥ä½¿ç”¨å¾—å½“","é»˜è®¤è¯„åˆ†ç†ç”±ï¼šæƒ…ç»ªè°ƒèŠ‚ç¨³å®š","é»˜è®¤è¯„åˆ†ç†ç”±ï¼šä¸»åŠ¨è¡¨è¾¾æ¸…æ™°","é»˜è®¤è¯„åˆ†ç†ç”±ï¼šå…³ç³»ç»´æŠ¤æœ‰æ•ˆ"],this.suggestion="å»ºè®®ï¼šå°è¯•è¡¨è¾¾è‡ªå·±çš„æ„Ÿå—å’Œç†ç”±ï¼Œå¹¶æå‡ºå…·ä½“æ‰¿è¯ºæˆ–æ”¹è¿›æŽªæ–½ï¼Œä¿ƒè¿›å»ºè®¾æ€§å¯¹è¯ã€‚",this.$nextTick((()=>{this.initRadarChart()}))}finally{this.isLoading=!1}},parseEvaluationData(t){this.radarIndicator=[{name:"å†²çªè½¬åŒ–",max:5},{name:"ç­–ç•¥ä½¿ç”¨",max:5},{name:"æƒ…ç»ªè°ƒèŠ‚",max:5},{name:"ä¸»åŠ¨è¡¨è¾¾",max:5},{name:"å…³ç³»ç»´æŠ¤",max:5}],this.radarData=[0,0,0,0,0],this.evaluationReasons=["","","","",""];const e=/(\d+)\.\s*([^:]+):\s*(\d+)/g;let a;while(null!==(a=e.exec(t))){const t=a[2].trim(),e=parseInt(a[3]),s=this.radarIndicator.findIndex((e=>e.name===t));-1!==s&&(this.radarData[s]=e)}const s=t.indexOf("è¯„åˆ†ç†ç”±ï¼š");if(-1!==s){const e=t.indexOf("å»ºè®®ï¼š"),a=t.indexOf("æ”¹è¿›å»ºè®®ï¼š");let i=t.length;-1!==e&&e>s?i=e:-1!==a&&a>s&&(i=a);let n=t.slice(s+5,i).trim();const o=n.split(/(?=\d+\. )/).filter(Boolean);o.forEach(((t,e)=>{if(e<5){const a=t.replace(/^\d+\.\s*/,"").trim(),s=a.indexOf("ï¼š");let i=a;-1!==s&&(i=a.slice(s+1).trim()),this.evaluationReasons[e]=i}}))}const i=t.indexOf("æ”¹è¿›å»ºè®®ï¼š");if(-1!==i)this.suggestion=t.slice(i+5).trim();else{const e=[/å»ºè®®ï¼š\s*(.+?)(?=\n\d+\.|$)/s,/æ”¹è¿›å»ºè®®ï¼š\s*(.+?)(?=\n\d+\.|$)/s,/å»ºè®®\s*(.+?)(?=\n\d+\.|$)/s];for(const a of e){const e=t.match(a);if(e){this.suggestion=e[1].trim();break}}if(!this.suggestion){const e=t.split("\n").filter((t=>t.trim())),a=e[e.length-1];a&&!a.match(/^\d+\./)&&(this.suggestion=a.trim())}}this.evaluationReasons=this.evaluationReasons.map(((t,e)=>t||"æš‚æ— è¯„åˆ†ç†ç”±")),console.log("è§£æžåŽçš„é›·è¾¾å›¾æ•°æ®:",{indicator:this.radarIndicator,data:this.radarData,reasons:this.evaluationReasons})},initRadarChart(){const t=document.getElementById("radarChart");if(!t)return void console.warn("é›·è¾¾å›¾DOMå…ƒç´ ä¸å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–");const e=H.Ts(t),a={tooltip:{},radar:{indicator:this.radarIndicator,splitLine:{lineStyle:{color:"#e0d7f7"}},splitArea:{areaStyle:{color:["#f6f0ff","#f3eaff"]}},axisLine:{lineStyle:{color:"#a084e8"}},name:{color:"#a084e8",fontSize:16}},series:[{name:"å¾—åˆ†",type:"radar",areaStyle:{color:"rgba(160, 132, 232, 0.3)"},lineStyle:{color:"#a084e8",width:3},itemStyle:{color:"#a084e8",borderColor:"#fff",borderWidth:2},data:[{value:this.radarData,name:"æ ·ä¾‹",areaStyle:{color:"rgba(160, 132, 232, 0.3)"},lineStyle:{color:"#a084e8",width:3},itemStyle:{color:"#a084e8",borderColor:"#fff",borderWidth:2}}]}]};e.setOption(a)}}},I=q,N=(0,d.A)(I,$,R,!1,null,"716f083d",null),D=N.exports;s["default"].use(C.Ay);const j=[{path:"/",name:"Main",component:P},{path:"/evaluation",name:"Evaluation",component:D,props:!0}],B=new C.Ay({routes:j});var V=B;s["default"].prototype.axios=w.A,s["default"].config.productionTip=!1,s["default"].use(_()),new s["default"]({router:V,render:t=>t(g)}).$mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,s,i,n){if(!s){var o=1/0;for(d=0;d<t.length;d++){s=t[d][0],i=t[d][1],n=t[d][2];for(var r=!0,c=0;c<s.length;c++)(!1&n||o>=n)&&Object.keys(a.O).every((function(t){return a.O[t](s[c])}))?s.splice(c--,1):(r=!1,n<o&&(o=n));if(r){t.splice(d--,1);var l=i();void 0!==l&&(e=l)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[s,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,n,o=s[0],r=s[1],c=s[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(c)var d=c(a)}for(e&&e(s);l<o.length;l++)n=o[l],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(d)},s=self["webpackChunksimulation"]=self["webpackChunksimulation"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(1344)}));s=a.O(s)})();
//# sourceMappingURL=app.d2a6e6e5.js.map